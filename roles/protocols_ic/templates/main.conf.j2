#jinja2:lstrip_blocks: True
{# role 'protocols_ia' in Playbook einbauen, um diesen Teil der config zu generieren 
#}
protocols {
    mstp {
        configuration-name interes-netz-2015;
        revision-level 1;
        bridge-priority {{ mstp.bridge_prio }};
    {% for _iface in interfaces %}
        {% set iface = interfaces[_iface] %}
        {% if (iface.mstp is defined and iface.mstp == 'disable') %}
        interface {{ _iface }}.0 {
            disable;
        }
        {% endif %}
    {% endfor %}
        interface downlinks {
            no-root-port;
        }
        interface xlinks {
            bpdu-timeout-action {
                block;
            }
        }
        msti 1 {
            bridge-priority {{ mstp.msti_1_prio }};
            vlan 1300-2399;
        }
        msti 2 {
            bridge-priority {{ mstp.msti_2_prio }};
            vlan 2400-3399;
        }
        msti 3 {
            bridge-priority {{ mstp.msti_3_prio }};
            vlan 3400-4094;
        }
        bpdu-block-on-edge;
    }
    lldp {
        port-id-subtype interface-name;
        interface downlinks;
        interface xlinks;
    }
}